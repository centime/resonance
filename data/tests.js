// Generated by CoffeeScript 1.4.0
(function() {
  var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  self.port.on('test', function(msg, param) {
    var d, displayed, fullSize, m, messages, ok, ok_, pmUsers, _i, _j, _len, _len1;
    if (msg === 'Test port communication') {
      self.port.emit('test', msg + ' : ' + document.title);
    }
    if (msg === 'App displayed, ~full ?') {
      displayed = $('#resonance_container') != null;
      fullSize = $('#resonance_container').width() > window.innerWidth * 9 / 10;
      self.port.emit('test', msg + ' : ' + (displayed && fullSize));
    }
    if (msg === 'Send message') {
      angular.element($('messages')).scope().newMessage = 'coucou';
      angular.element($('messages')).scope().submitNewMessage();
    }
    if (msg === 'Are messages in history really displayed ?') {
      ok = true;
      messages = angular.element($('messages')).scope().messages;
      for (_i = 0, _len = param.length; _i < _len; _i++) {
        m = param[_i];
        ok_ = false;
        for (_j = 0, _len1 = messages.length; _j < _len1; _j++) {
          d = messages[_j];
          if ((d.author === m.author) && (d.message === m.message) && d.display) {
            ok_ = true;
          }
        }
        if (!ok_) {
          ok = false;
        }
      }
      self.port.emit('test', msg + ' : ' + ok);
    }
    if (msg === 'Updated pm users list ?') {
      pmUsers = angular.element($('privateusers')).scope().pmUsers;
      return self.port.emit('test', msg + ' : ' + (__indexOf.call(pmUsers, param) >= 0));
    }
  });

}).call(this);
