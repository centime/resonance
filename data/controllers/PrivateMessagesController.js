// Generated by CoffeeScript 1.4.0
(function() {

  window.app.controller("PrivateMessagesController", function($scope) {
    var currentPmUser, elmt;
    $scope.messages = [];
    $scope.newMessage = '';
    currentPmUser = 'Resonance-bot';
    self.port.on("pmUser", function(user, history) {
      currentPmUser = user;
      return $scope.messages = history;
    });
    elmt = angular.element('privatemessages > ul');
    $scope.submitNewMessage = function() {
      var msg;
      msg = $scope.newMessage;
      if (msg !== '') {
        self.port.emit('privateMessage', currentPmUser, msg);
      }
      return $scope.newMessage = '';
    };
    return self.port.on("privateMessage", function(from, to, message) {
      var entry;
      entry = {
        'author': from,
        'message': message
      };
      $scope.messages.push(entry);
      $scope.$apply();
      return elmt.animate({
        scrollTop: elmt.prop('scrollHeight')
      }, 1000);
    });
  });

}).call(this);
