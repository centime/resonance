// Generated by CoffeeScript 1.4.0
(function() {

  window.app.controller("TopPagesController", function($scope) {
    var askedAlready;
    $scope.topPages = [];
    self.port.on('topPages', function(topPages) {
      var i, p, page, pages, s, v, visitors;
      s = topPages.split(',');
      pages = (function() {
        var _i, _len, _results, _step;
        _results = [];
        for (_i = 0, _len = s.length, _step = 2; _i < _len; _i += _step) {
          p = s[_i];
          _results.push(p);
        }
        return _results;
      })();
      visitors = (function() {
        var _i, _len, _ref, _results, _step;
        _ref = s.slice(1);
        _results = [];
        for (_i = 0, _len = _ref.length, _step = 2; _i < _len; _i += _step) {
          v = _ref[_i];
          _results.push(v);
        }
        return _results;
      })();
      $scope.topPages = (function() {
        var _i, _len, _results;
        _results = [];
        for (i = _i = 0, _len = pages.length; _i < _len; i = ++_i) {
          page = pages[i];
          _results.push([page, visitors[i]]);
        }
        return _results;
      })();
      return $scope.$apply();
    });
    askedAlready = false;
    return $scope.getTopPages = function(displayTopPages) {
      if (displayTopPages && !askedAlready) {
        self.port.emit('getTopPages');
        askedAlready = true;
      } else if (!displayTopPages && askedAlready) {
        askedAlready = false;
      }
      return displayTopPages;
    };
  });

}).call(this);
